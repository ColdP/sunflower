<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>向日葵 - n-buna</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <!-- Google Fonts: 本体フォント -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&family=Noto+Sans+JP:wght@400;500;700&family=Noto+Serif+SC:wght@400;500;700&display=swap" rel="stylesheet">
    <!-- Google Fonts: アイコン -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" />
    <style>
        /* * 基本のフォント設定です。言語に応じてフォントを切り替えます。
         */
        body {
            background-color: #FEFDFB; /* 全体の背景を温かみのある白に設定 */
        }
        /* 日本語用のフォント */
        body.lang-ja {
            font-family: 'Inter', 'Noto Sans JP', sans-serif;
        }
        /* 英語用のフォント */
        body.lang-en {
            font-family: 'Times New Roman', serif;
        }
        /* 中国語用のフォント */
        body.lang-zh-CN, body.lang-zh-TW {
            font-family: 'STZhongsong', 'Noto Serif SC', serif; /* 华文中宋 */
        }

        /* * Material 3 Expressiveのスタイルを取り入れた波線SVGです。
         */
        .expressive-divider {
            width: 100%;
            height: 20px;
            stroke: #FDE68A; /* 淡い黄色の波線 */
            stroke-width: 3;
            fill: none;
        }

        /* * 音楽プレーヤーのプログレスバーのスタイルです。
         */
        .progress-bar-container {
            background-color: rgba(253, 230, 138, 0.3); /* 淡い黄色の背景 */
        }
        
        .progress-bar {
            background-color: #FBBF24; /* 濃い黄色で進捗を表示 */
        }
        
        /* * ループボタンがアクティブな時のスタイルです。
         * 背景色を常時点灯させ、状態を分かりやすくします。
         */
        .loop-active {
            background-color: #fde68a; /* 明るい黄色の背景 */
            color: #a16207; /* アイコンの色を濃い琥珀色に */
        }
        
        /* Google Fonts Iconsの基本スタイル */
        .material-symbols-outlined {
          font-variation-settings:
          'FILL' 0,
          'wght' 400,
          'GRAD' 0,
          'opsz' 24
        }
    </style>
</head>
<body class="antialiased text-zinc-800 lang-ja">

    <!-- 
      メインコンテナです。
      position: relative を設定し、言語スイッチャーを配置する基準とします。
    -->
    <main class="relative max-w-3xl mx-auto my-8 sm:my-16 p-6 sm:p-10 bg-amber-50/70 rounded-3xl shadow-lg transition-all duration-300">
        
        <!-- 言語切り替えドロップダウン -->
        <div id="language-switcher" class="absolute top-4 right-4 sm:top-6 sm:right-8">
            <button id="language-toggle-btn" class="p-2 rounded-full hover:bg-white/80 transition-colors flex items-center justify-center">
                <!-- Google Fonts "Language" Icon -->
                <span class="material-symbols-outlined text-zinc-600">language</span>
            </button>
            <div id="language-menu" class="hidden absolute right-0 mt-2 w-32 bg-white rounded-xl shadow-lg z-10">
                <a href="#" class="block px-4 py-2 text-sm text-zinc-700 hover:bg-amber-100/50 rounded-t-xl" data-lang="ja">日本語</a>
                <a href="#" class="block px-4 py-2 text-sm text-zinc-700 hover:bg-amber-100/50" data-lang="zh-CN">简体中文</a>
                <a href="#" class="block px-4 py-2 text-sm text-zinc-700 hover:bg-amber-100/50" data-lang="zh-TW">繁體中文</a>
                <a href="#" class="block px-4 py-2 text-sm text-zinc-700 hover:bg-amber-100/50 rounded-b-xl" data-lang="en">English</a>
            </div>
        </div>

        <!-- ヘッダー部分：タイトル、日付、作者名 -->
        <header class="mb-8 text-center pt-8 sm:pt-0">
            <h1 id="content-title" class="text-4xl sm:text-5xl font-bold text-amber-900/90 tracking-wider">向日葵</h1>
            <div id="content-meta" class="mt-4 text-sm text-zinc-500 tracking-widest">
                <span>2025.07.04</span>
                <span class="mx-2">/</span>
                <span>n-buna</span>
            </div>
        </header>

        <!-- 前書きのセクション -->
        <section id="content-diary" class="max-w-none bg-white/60 p-6 rounded-2xl mb-8">
            <div class="space-y-6 leading-relaxed text-base text-zinc-800">
                <p>向日葵という曲と絵を書いた。ヨルシカは関係のないごく個人的な作。歌詞を書きながら、ピアノを弾いて録音していた。</p>
                <p>昔、妻と二人である海岸に行った。富山と新潟の間にある閑静な砂浜で、波打ち際のテトラポットで足を滑らせてびしょ濡れになったことを覚えている。服は堤防の上を歩いているうちに乾いた。</p>
                <p>毎月、帰り道の途中で花を買って帰る。勿体無いのでドライフラワーにしたいと妻は言うのだけれど、そうすると家がどんどん花で溢れてしまうと困っている。なので最近は、花瓶にさして栄養剤を入れて、萎れるまで見ている。</p>
                <p>プロポーズの時に向日葵の花を渡した。妻は音楽とは殆ど関わりがない生活をしていて、だからこそ心地良くて、ずっと僕にとっての太陽だった。これからもそうだと思う。永遠に変わらないと誓える。</p>
            </div>
        </section>

        <!-- 波線の区切り -->
        <div class="w-full flex justify-center my-8">
            <svg class="expressive-divider" viewBox="0 0 100 20" preserveAspectRatio="none">
                <path d="M 0 10 C 20 0, 40 20, 60 10 S 80 0, 100 10" />
            </svg>
        </div>
        
        <!-- プロポーズの言葉セクション -->
        <section id="content-proposal" class="relative text-center my-12">
            <span class="absolute -top-8 left-1/2 -translate-x-1/2 text-9xl text-amber-500 opacity-10 font-serif select-none">“</span>
            <p class="text-2xl font-semibold text-amber-800/90 tracking-widest">結婚してください</p>
        </section>
        

        <!-- 歌詞のセクション -->
        <section class="lyrics text-center leading-loose tracking-wider text-zinc-700">
            <h2 id="content-lyrics-title" class="text-2xl font-bold text-amber-900/80 mb-6">向日葵</h2>
            <div id="content-lyrics" class="space-y-6 text-base">
                <p>私の命をあなたにあげたい<br>私の命をあなたにあげたい</p>
                <p>夏の海原<br>裸足のまま<br>あなたを呼ぶ間に<br>足が濡れる</p>
                <p>波を忘れて<br>乾いた肌<br>あなたの引く手に<br>燃えるからだ</p>
                <p>私の命をあなたにあげたい<br>私の命をあなたにあげたい<br>渡り、海の風をあなたにあげたい<br>風を受ける腕をあなたにあげたい</p>
                <p>海は草原<br>あなたは莢<br>陰るも知らずに<br>裸足のまま</p>
                <p>昼を忘れて<br>あなたは咲く<br>日差しよ日差しよ<br>どこまでゆく</p>
                <p>私の命をあなたにあげたい<br>私の命ただあなたにあげたい<br>轍残す足をあなたにあげたい<br>山に落ちる影もあなたにあげたい</p>
                <p>私の祈りをあなたにあげたい<br>私の痛みもあなたにあげたい<br>海も裂ける夜をあなたにあげたい<br>それを焼く光をあなたにあげたい</p>
                <p>私の命をあなたにあげたい<br>私の命をあなたにあげたい</p>
                <p>私の命をあなたにあげたい<br>私の命をあなたにあげたい</p>
            </div>
        </section>

        <!-- カバー画像のセクション -->
        <footer class="mt-12">
            <img 
                src="cover.png" 
                alt="向日葵のアルバムカバーアート" 
                class="w-full h-auto rounded-2xl shadow-md object-cover"
                onerror="this.onerror=null;this.src='https://placehold.co/600x600/FDF6B2/333333?text=Image+Not+Found';"
            >
        </footer>

        <!-- 音楽プレーヤーのセクション -->
        <section id="music-player" class="mt-8 p-4 bg-white/60 rounded-2xl">
            <div class="flex items-center space-x-4">
                <!-- 再生/一時停止ボタン -->
                <button id="playPauseBtn" class="flex-shrink-0 w-14 h-14 bg-amber-300 hover:bg-amber-400 transition-colors duration-300 rounded-full flex items-center justify-center text-amber-800 shadow-md focus:outline-none focus:ring-2 focus:ring-amber-400 focus:ring-opacity-75">
                    <svg id="playIcon" class="w-8 h-8" viewBox="0 0 24 24" fill="currentColor"><path d="M8 5v14l11-7z"></path></svg>
                    <svg id="pauseIcon" class="w-8 h-8 hidden" viewBox="0 0 24 24" fill="currentColor"><path d="M6 19h4V5H6v14zm8-14v14h4V5h-4z"></path></svg>
                </button>
                <!-- プログレスバーと時間表示 -->
                <div class="w-full">
                    <div id="progressBarContainer" class="progress-bar-container w-full h-3 rounded-full cursor-pointer">
                        <div id="progressBar" class="progress-bar h-full rounded-full" style="width: 0%;"></div>
                    </div>
                    <div class="flex justify-between text-xs text-zinc-500 mt-1">
                        <span id="currentTime">0:00</span>
                        <span id="totalDuration">0:00</span>
                    </div>
                </div>
                <!-- ループボタン -->
                <button id="loopBtn" class="flex-shrink-0 w-10 h-10 flex items-center justify-center rounded-full text-zinc-500 hover:bg-amber-100/50 transition-colors">
                    <!-- Google Fonts "Repeat" Icon -->
                    <span class="material-symbols-outlined">repeat</span>
                </button>
            </div>
            <audio id="audioPlayer" src="sf.mp3"></audio>
        </section>

    </main>

    <script>
        // --- 多言語対応の翻訳データ ---
        const translations = {
            'ja': {
                title: '向日葵',
                meta: '2025.07.04 / n-buna',
                diary: [
                    '向日葵という曲と絵を書いた。ヨルシカは関係のないごく個人的な作。歌詞を書きながら、ピアノを弾いて録音していた。',
                    '昔、妻と二人である海岸に行った。富山と新潟の間にある閑静な砂浜で、波打ち際のテトラポットで足を滑らせてびしょ濡れになったことを覚えている。服は堤防の上を歩いているうちに乾いた。',
                    '毎月、帰り道の途中で花を買って帰る。勿体無いのでドライフラワーにしたいと妻は言うのだけれど、そうすると家がどんどん花で溢れてしまうと困っている。なので最近は、花瓶にさして栄養剤を入れて、萎れるまで見ている。',
                    'プロポーズの時に向日葵の花を渡した。妻は音楽とは殆ど関わりがない生活をしていて、だからこそ心地良くて、ずっと僕にとっての太陽だった。これからもそうだと思う。永遠に変わらないと誓える。'
                ],
                proposal: '結婚してください',
                lyricsTitle: '向日葵',
                lyrics: [
                    '私の命をあなたにあげたい<br>私の命をあなたにあげたい',
                    '夏の海原<br>裸足のまま<br>あなたを呼ぶ間に<br>足が濡れる',
                    '波を忘れて<br>乾いた肌<br>あなたの引く手に<br>燃えるからだ',
                    '私の命をあなたにあげたい<br>私の命をあなたにあげたい<br>渡り、海の風をあなたにあげたい<br>風を受ける腕をあなたにあげたい',
                    '海は草原<br>あなたは莢<br>陰るも知らずに<br>裸足のまま',
                    '昼を忘れて<br>あなたは咲く<br>日差しよ日差しよ<br>どこまでゆく',
                    '私の命をあなたにあげたい<br>私の命ただあなたにあげたい<br>轍残す足をあなたにあげたい<br>山に落ちる影もあなたにあげたい',
                    '私の祈りをあなたにあげたい<br>私の痛みもあなたにあげたい<br>海も裂ける夜をあなたにあげたい<br>それを焼く光をあなたにあげたい',
                    '私の命をあなたにあげたい<br>私の命をあなたにあげたい',
                    '私の命をあなたにあげたい<br>私の命をあなたにあげたい'
                ]
            },
            'zh-CN': {
                title: '向日葵',
                meta: '2025.07.04 / n-buna',
                diary: [
                    '我创作了《向日葵》的曲子和画。与ヨルシカ无关的，是非常私人性的作品。写歌词的时候，我一边弹着钢琴一边录音。',
                    '曾经，我和妻子两个人去过一个海岸。我记得是在富山和新潟之间一个僻静的沙滩上，在海浪拍打的防波堤上脚下一滑，弄得浑身湿透。衣服是在沿着堤防走的时候慢慢干的。',
                    '每个月回家路上都会买花带回去。妻子觉得太浪费了，想做成干花，但那样的话家里就会被花一点点填满，很让人头疼。所以最近都是插在花瓶里，放了营养剂，就这样一直看着它枯萎为止。',
                    '求婚的时候送了她向日葵。妻子的生活几乎和音乐毫无关联，正因如此才让我觉得安心和舒适，她一直是我心里的太阳。我想以后也会是这样。我发誓，这份心意永远不会改变。'
                ],
                proposal: '请和我结婚',
                lyricsTitle: '向日葵',
                lyrics: [
                    '我想把我的生命献给你<br>我想把我的生命献给你',
                    '夏日的大海原<br>光着脚<br>呼唤你的时候<br>脚被海水打湿',
                    '忘记了波浪<br>干燥的肌肤<br>在你拉住的手里<br>燃烧的身体',
                    '我想把我的生命献给你<br>我想把我的生命献给你<br>想把渡过的海风献给你<br>想把迎风的手臂献给你',
                    '大海是草原<br>你是豆荚<br>不知阴影为何物<br>依然光着脚',
                    '忘记了正午<br>你在绽放<br>阳光啊阳光啊<br>要去往何处',
                    '我想把我的生命献给你<br>只想把我的生命献给你<br>想把留有车辙的足迹献给你<br>想把落在山上的影子献给你',
                    '想把我的祈祷献给你<br>想把我的痛苦也献给你<br>想把连大海都要裂开的夜晚献给你<br>想把将它燃尽的光芒献给你',
                    '我想把我的生命献给你<br>我想把我的生命献给你',
                    '我想把我的生命献给你<br>我想把我的生命献给你'
                ]
            },
            'zh-TW': {
                title: '向日葵',
                meta: '2025.07.04 / n-buna',
                diary: [
                    '我寫了一首叫《向日葵》的曲子和畫。跟ヨルシカ沒有關係，是非常私人的作品。寫歌詞的時候，一邊彈著鋼琴一邊錄音。',
                    '以前，和妻子兩個人去過一個海岸。我記得是在富山和新潟之間一個僻靜的沙灘上，在海浪拍打的防波堤上腳下一滑，弄得渾身濕透。衣服是在沿著堤防走的時候慢慢乾的。',
                    '每個月回家的路上都會買花回去。妻子說因為可惜所以想做成乾花，但那樣的話家裡會越來越被花填滿，就有點頭疼。於是最近是插在花瓶裡，加上營養劑，就這樣看著它們直到枯萎。',
                    '求婚的時候送了她一朵向日葵。妻子幾乎和音樂無緣，正因為如此，她的生活讓我感到安心，她一直是我心中的太陽。我覺得今後也會是這樣。我可以發誓，這份心意永遠不會改變。'
                ],
                proposal: '請和我結婚',
                lyricsTitle: '向日葵',
                lyrics: [
                    '我想把我的生命獻給你<br>我想把我的生命獻給你',
                    '夏日的海原<br>赤著腳<br>呼喚你的時候<br>腳被海水打濕',
                    '忘記了浪潮<br>乾燥的肌膚<br>在你拉著的手中<br>燃燒的身體',
                    '我想把我的生命獻給你<br>我想把我的生命獻給你<br>想把渡過的海風獻給你<br>想把迎風的手臂獻給你',
                    '大海是草原<br>你是豆莢<br>不知陰影為何物<br>依然赤腳',
                    '忘記了正午<br>你在綻放<br>陽光啊陽光啊<br>要到哪裡去',
                    '我想把我的生命獻給你<br>只想把我的生命獻給你<br>想把留下車轍的足跡獻給你<br>想把落在山上的影子獻給你',
                    '想把我的祈禱獻給你<br>想把我的痛苦也獻給你<br>想把連大海都要裂開的夜晚獻給你<br>想把將其燃盡的光芒獻給你',
                    '我想把我的生命獻給你<br>我想把我的生命獻給你',
                    '我想把我的生命獻給你<br>我想把我的生命獻給你'
                ]
            },
            'en': {
                title: 'Sunflower',
                meta: '2025.07.04 / n-buna',
                diary: [
                    'I wrote a song and a painting called “Sunflower.” It has nothing to do with Yorushika—it’s a very personal piece. While writing the lyrics, I recorded myself playing the piano.',
                    'Long ago, my wife and I went to a certain beach. I remember it was a quiet stretch of sand between Toyama and Niigata. I slipped on the tetrapods at the water’s edge and got soaking wet. My clothes dried as we walked along the seawall.',
                    'Every month on my way home, I buy flowers. My wife says it’s a waste not to make them into dried flowers, but then the house would fill up with them, which is a bit of a problem. So lately, I’ve just been putting them in a vase with nutrients and watching them until they wither.',
                    'When I proposed, I gave her a sunflower. My wife has almost nothing to do with music in her daily life, and that’s precisely why it’s so comforting. She’s always been my sun. I think she always will be. I can swear this will never change.'
                ],
                proposal: 'Please marry me',
                lyricsTitle: 'Sunflower',
                lyrics: [
                    'I want to give you my life<br>I want to give you my life',
                    'The summer ocean<br>Barefoot<br>While calling you<br>My feet get wet',
                    'Forgetting the waves<br>Dry skin<br>In the hand you pull<br>Burning body',
                    'I want to give you my life<br>I want to give you my life<br>I want to give you the wind crossing the sea<br>I want to give you these wind-catching arms',
                    'The sea is a prairie<br>You are a pod<br>Unknowing of shadows<br>Still barefoot',
                    'Forgetting midday<br>You bloom<br>Sunlight, oh sunlight<br>Where will you go',
                    'I want to give you my life<br>Just want to give you my life<br>I want to give you feet that leave ruts behind<br>I want to give you the shadow that falls on mountains',
                    'I want to give you my prayers<br>I want to give you my pain<br>I want to give you the night that even splits the sea<br>I want to give you the light that burns it away',
                    'I want to give you my life<br>I want to give you my life',
                    'I want to give you my life<br>I want to give you my life'
                ]
            }
        };

        // --- Media Session APIのセットアップ ---
        function setupMediaSession(lang) {
            if ('mediaSession' in navigator) {
                const data = translations[lang];
                if (!data) return;

                navigator.mediaSession.metadata = new MediaMetadata({
                    title: data.title,
                    artist: 'n-buna',
                    album: data.lyricsTitle, // アルバム名も曲名と同じに設定
                    artwork: [
                        { src: 'cover.png', sizes: '512x512', type: 'image/png' }
                    ]
                });
            }
        }

        // --- 言語切り替えのロジック ---
        const languageToggleBtn = document.getElementById('language-toggle-btn');
        const languageMenu = document.getElementById('language-menu');
        
        languageToggleBtn.addEventListener('click', (e) => {
            e.stopPropagation();
            languageMenu.classList.toggle('hidden');
        });

        document.addEventListener('click', () => {
            if (!languageMenu.classList.contains('hidden')) {
                languageMenu.classList.add('hidden');
            }
        });

        languageMenu.addEventListener('click', (e) => {
            e.preventDefault();
            const lang = e.target.dataset.lang;
            if (lang) {
                updateContent(lang);
                languageMenu.classList.add('hidden');
            }
        });

        function updateContent(lang) {
            const data = translations[lang];
            if (!data) return;

            document.body.className = document.body.className.replace(/lang-\S+/g, `lang-${lang}`);
            document.getElementById('content-title').textContent = data.title;
            document.getElementById('content-meta').innerHTML = `<span>${data.meta.split(' / ')[0]}</span><span class="mx-2">/</span><span>${data.meta.split(' / ')[1]}</span>`;
            
            const diaryContainer = document.querySelector('#content-diary > div');
            diaryContainer.innerHTML = data.diary.map(p_text => `<p>${p_text}</p>`).join('');
            
            document.querySelector('#content-proposal p').textContent = data.proposal;

            document.getElementById('content-lyrics-title').textContent = data.lyricsTitle;
            const lyricsContainer = document.getElementById('content-lyrics');
            lyricsContainer.innerHTML = data.lyrics.map(p_text => `<p>${p_text}</p>`).join('');
            
            // 言語変更時にメディアセッション情報も更新
            setupMediaSession(lang);
        }


        // --- 音楽プレーヤーのロジック ---
        const audioPlayer = document.getElementById('audioPlayer');
        const playPauseBtn = document.getElementById('playPauseBtn');
        const playIcon = document.getElementById('playIcon');
        const pauseIcon = document.getElementById('pauseIcon');
        const progressBarContainer = document.getElementById('progressBarContainer');
        const progressBar = document.getElementById('progressBar');
        const currentTimeEl = document.getElementById('currentTime');
        const totalDurationEl = document.getElementById('totalDuration');
        const loopBtn = document.getElementById('loopBtn');

        playPauseBtn.addEventListener('click', () => {
            if (audioPlayer.paused) {
                audioPlayer.play();
            } else {
                audioPlayer.pause();
            }
        });

        audioPlayer.addEventListener('play', () => {
            playIcon.classList.add('hidden');
            pauseIcon.classList.remove('hidden');
            if ('mediaSession' in navigator) {
                navigator.mediaSession.playbackState = 'playing';
            }
        });

        audioPlayer.addEventListener('pause', () => {
            playIcon.classList.remove('hidden');
            pauseIcon.classList.add('hidden');
            if ('mediaSession' in navigator) {
                navigator.mediaSession.playbackState = 'paused';
            }
        });

        function formatTime(seconds) {
            if (isNaN(seconds)) return '0:00';
            const minutes = Math.floor(seconds / 60);
            const secs = Math.floor(seconds % 60);
            return `${minutes}:${secs < 10 ? '0' : ''}${secs}`;
        }

        audioPlayer.addEventListener('loadedmetadata', () => {
            totalDurationEl.textContent = formatTime(audioPlayer.duration);
        });

        audioPlayer.addEventListener('timeupdate', () => {
            const progressPercent = (audioPlayer.currentTime / audioPlayer.duration) * 100;
            progressBar.style.width = `${progressPercent || 0}%`;
            currentTimeEl.textContent = formatTime(audioPlayer.currentTime);
        });

        progressBarContainer.addEventListener('click', (e) => {
            const width = progressBarContainer.clientWidth;
            const clickX = e.offsetX;
            const duration = audioPlayer.duration;
            if (duration) {
                audioPlayer.currentTime = (clickX / width) * duration;
            }
        });

        loopBtn.addEventListener('click', () => {
            audioPlayer.loop = !audioPlayer.loop;
            loopBtn.classList.toggle('loop-active', audioPlayer.loop);
        });
        
        // --- 初期化処理 ---
        document.addEventListener('DOMContentLoaded', () => {
            // ページ読み込み時にデフォルト言語でメディアセッションを設定
            setupMediaSession('ja');

            // OSのメディアコントロールからの操作をハンドル
            if ('mediaSession' in navigator) {
                navigator.mediaSession.setActionHandler('play', () => audioPlayer.play());
                navigator.mediaSession.setActionHandler('pause', () => audioPlayer.pause());
                // 他のコントロール（nexttrack, previoustrackなど）もここに追加可能
            }
        });

    </script>

</body>
</html>
